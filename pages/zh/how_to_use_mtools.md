# 如何使用MTools

首先，它是一个APP，我曾经用我的NFC手机--Moto X 2013将十六进制数据写回mifare 1k卡。经过几个步骤的研究和开发，我找到了一种方法从卡中读取货币数据并生成合法的十六进制 然后将数据写回卡中。 而且效果很好，让我很开心。 看起来像我是一个暗黑的黑客，可以通过一个简单的应用程序轻松改变卡上的金额。
在那之后，我想与所有对RFID感兴趣的人分享这种快乐。 经过大约3周的开发，第一版MTools问世。
以下是您需要了解的以更好得使用他。

- 获取所有扇区的密钥
- 比较以找到很有金额数据的扇区
- 向MTools添加卡，扇区和密钥
- 在嗅探器中记录每次消费后的数据
- 比较和分析动态字节的规则
- 完成表达式
- 一键即充

---

## 获取所有扇区的密钥

一些卡片使用默认密钥，像 `FFFFFFFFFFFF` `000000000000` `A1B2C3D4E56F` 等等，你还可以通过**Mifare Classic Tools**尝试卡片是否使用了这些密钥。 
如果卡未完全加密，则可能会被RFID设备爆破，比如**ACR122U** 或**PN532**。

如果卡已完全加密，则只有**PM3**可以破解密钥。

## 比较以找到很有金额数据的扇区

使用卡的所有扇区的keyA或keyB，就可以收集数据。 并在每次消费后对它们进行比较，这样你就可以找到数据发生变化的部门，这意味着该扇区可能有金额数据。

## 向MTools添加卡，扇区和密钥

每个扇区的第4块包括

`keyA(6 bytes) +  Access Control(4) + keyB(6)`

## 在嗅探器中记录每次消费后的数据

通过添加扇区号和有效密钥，可以很容易地比较具有不同金额的数据。

标记金额字节（包含货币数据）和检查字节（主要是变化的字节）

## 比较和分析动态字节的规则

金额字节上注意十六进制或十进制，是否倒置和倍率问题。

校验位请比较上下两位的和或异或值来找到规律。

## 完成表达式
MTools 使用[mXparser](http://mathparser.org/) 来计算规则，请根据MTools中的提示来添加表达式。
## 一键即充

充值前，请贴卡，然后长安$按钮模拟计算，保住数据无误后再写入。

 ## One more thing
MTools 支持外置设备 ACR122U，意味着就算没有NFC的手机同样可以使用MTools。